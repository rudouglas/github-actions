---
subject: Node.js agent
releaseDate: '2018-07-31'
version: 4.7.0
---

### New features

* Added support for distributed tracing.

  Distributed tracing lets you see the path that a request takes as it travels through your distributed system. By showing the distributed activity through a unified view, you can troubleshoot and understand a complex system better than ever before.

  Distributed tracing is available with an APM Pro or equivalent subscription. To see a complete distributed trace, you need to enable the feature on a set of neighboring services. Enabling distributed tracing changes the behavior of some New Relic features, so carefully consult the [transition guide](https://docs.newrelic.com/docs/transition-guide-distributed-tracing) before you enable this feature.

  To enable distributed tracing, set `distributed_tracing.enabled` to `true` in your `newrelic.js` file, or set `NEW_RELIC_DISTRIBUTED_TRACING_ENABLED` in your environment.
* Added a warning for too-new versions of Node.js during agent startup.
* Appropriately obfuscated SQL statements will now be included in all transaction traces.

  Previously, the agent would only include the SQL statements if the corresponding query was sufficiently slow.
* Added ability to execute instrumentation functions in the context of the segment the segment descriptor is describing.

  All `record*` methods supplied by all instrumentation shim classes now allow for a function to be executed under the context of the segment the record call will produce. This may be done by supplying a function in the `inContext` key for the segment descriptor passed to the record method.
* Reservoirs will now respect setting their size to 0.
