---
subject: Node.js agent
releaseDate: '2018-11-15'
version: 4.11.0
downloadLink: 'https://www.npmjs.com/package/newrelic'
---

### New features

* Added `protocol_17` feature flag.

  Flag will be removed and protocol will be hard-coded to `17` once functionality is released on New Relic backend.
* This release also includes changes to the agent to enable monitoring of Lambda functions. If you are interested in learning more or previewing New Relic Lambda monitoring please email [lambda_preview@newrelic.com](mailto:lambda_preview@newrelic.com).
* Added `waitForIdle` option to `API#shutdown`.

  This new option will make the agent wait for all active transactions to finish before actually shutting down. This does not pre-empt creation of new transactions, so care must be taken to ensure the active transaction pool drains or the agent will never shut down.

### Improvements

* Added switch statement indenting standard to eslintrc
* Introduced "warn" level 2 space rule to eslintrc
* Upgraded `@newrelic/test-utilities` to v2.

### Bug fixes

* Changed totalTime attribute to be in decimal seconds instead of milliseconds for transaction events.
* Agent no longer produces spans on ignored transactions.

  Previously, the agent would produce distributed tracing span events regardless of the ignored status of the transaction the events originated from.
* Extended Restify instrumentation to mark possible transaction names in order to account for async response methods.
* Updated `hapi@16` versioned tests to only run on Node 6 and above.
* Pinned mysql2 to `<1.6.2` in versioned tests.
