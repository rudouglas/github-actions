---
subject: Node.js agent
releaseDate: '2018-05-15'
version: 4.1.1
downloadLink: 'https://npmjs.org/package/newrelic'
---

### Improvements

* Optimized `unhandledRejection` reporting when using `async_hooks`.
* Replaced all uses of `util._extend` with `Object.assign`.
* Completed TODOs regarding the Node 0.10 and 0.12 deprecation.
* Added PriorityQueue serialization benchmarks.

### Bug fixes

* The agent no longer resizes the metric timeslice start time to be the earliest start time of the transactions that finish during the timeslice.
* Background transactions created may now be named through `API#setTransactionName`.

  Previously, the agent didn't respect the transaction naming precedence for background transactions. Background transaction naming behavior is now in line with web transaction behavior.
* Logger no longer tries to create very large log messages.

  When a message is created that would be too large to log, a process warning is emitted.
* The agent will now respect event count limits when merging data from a failed send.

  Previously, when merging data into an event pool the agent wouldn't maintain the size limit of the reservoir.
* Added check for a route prefix when wrapping Hapi route handlers.

  Previously, route prefixes specified via plugin options weren't being included in transaction names. Now, if the agent finds a route prefix associated with a given realm, it is prepended to the route path in the transaction name.
