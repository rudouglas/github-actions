---
subject: Node.js agent
releaseDate: '2020-03-19'
version: 6.5.0
downloadLink: 'https://www.npmjs.com/package/newrelic'
---

## Improvements

* Added error attributes to spans.

  * The public api method `noticeError()` now attaches exception details to the currently executing span. Spans with error details are now highlighted red in the Distributed Tracing UI. Also, the attributes `error.class` and `error.message` are added to the span. If multiple errors are recorded for a single span, only the final error's attributes will be added to the span.
  * Added ID of the span in which an error occurred to the corresponding transaction error event.
* Added new public API methods `addCustomSpanAttribute` and `addCustomSpanAttributes` to add attributes to the currently executing span.
* Added new attributes to http outbound spans: `http.statusCode` and `http.statusText`.
* Updated W3C Trace Context "Known Issues and Workaround" notes with latest accurate consideration.
* Converted unit tests to run via `tap`. Removes `mocha` dependency.

## Fixes

* Fixed route naming when hapi's `pre` route handlers share functions.
* Fixed `child_process` instrumentation so that handlers can be effectively removed when attached via `.once()` or manually removed via `removeListener()`.
