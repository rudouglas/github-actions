---
subject: Ruby agent
releaseDate: '2018-04-30'
version: 5.1.0.344
downloadLink: 'https://rubygems.org/downloads/newrelic_rpm-5.1.0.344.gem'
---

### Notes

* Rails 5.2 support

  The Ruby agent has been validated against the latest release of Ruby on Rails!
* Support for newer libraries and frameworks

  We have updated the multiverse suite to test the agent against current versions of several frameworks.
* Add `custom_attributes.enabled` configuration option

  This option is enabled by default. When it's disabled, custom attributes will not be transmitted on transaction events or error events.
* Fix Grape load order dependency

  The agent will now choose the correct name for Grape transactions even if the customer's app loads the agent before Grape. Thanks to Daniel Doubrovkine for the contribution!
* Add `webpacker:compile` to blacklisted tasks

  `webpacker:compile` is commonly used for compiling assets. It has been added to `AUTOSTART_BLACKLISTED_RAKE_TASKS` in the default configuration. Thanks to Claudio B. for the contribution!
* Make browser instrumentation W3C-compliant

  `type="text/javascript"` is optional for the `<script>` tag under W3C. The `type` attribute has now been removed from browser instrumentation. Thanks to Spharian for the contribution!
* Deferred `add_method_tracer` calls

  If a third-party library calls `add_method_tracer` before the agent has finished starting, we now queue these calls and run them when it's safe to do so (rather than skipping them and logging a warning).
* Bugfix for Resque `around` / `before` hooks

  In rare cases, the agent was not instrumenting Resque `around` and `before` hooks. This version fixes the error.
* Truncation of long stack traces

  Occasionally, long stack traces would cause complications sending data to New Relic. This version truncates long traces to 50 frames (split evenly between the top and bottom of the trace).
